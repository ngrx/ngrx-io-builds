5a1c589a refactor: improve typing & replace deprecated inject usages (#3606)
