{
  "id": "guide/store/configuration/runtime-checks",
  "title": "Runtime checks",
  "contents": "\n\n\n  <div class=\"github-links\">\n    <a href=\"https://github.com/ngrx/platform/edit/master/projects/ngrx.io/content/guide/store/configuration/runtime-checks.md?message=docs%3A%20describe%20your%20change...\" aria-label=\"Suggest Edits\" title=\"Suggest Edits\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n  </div>\n\n\n<div class=\"content\">\n<h1 id=\"runtime-checks\">Runtime checks<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/store/configuration/runtime-checks#runtime-checks\"><i class=\"material-icons\">link</i></a></h1>\n<p>Runtime checks are here to guide developers to follow the NgRx and Redux core concepts and best practices. They are here to shorten the feedback loop of easy-to-make mistakes when you're starting to use NgRx, or even a well-seasoned developer might make. During development, when a rule is violated, an error is thrown notifying you what and where something went wrong.</p>\n<p><code>@ngrx/store</code> ships with three built-in runtime checks:</p>\n<ul>\n<li><a href=\"guide/store/configuration/runtime-checks#strictimmutability\"><code>strictImmutability</code></a>: verifies that the state and actions aren't being mutated</li>\n<li><a href=\"guide/store/configuration/runtime-checks#strictstateserializability\"><code>strictStateSerializability</code></a>: verifies if the state is serializable</li>\n<li><a href=\"guide/store/configuration/runtime-checks#strictactionserializability\"><code>strictActionSerializability</code></a>: verifies if the actions are serializable</li>\n</ul>\n<p>These checks are all opt-in and will automatically be disabled in production builds.</p>\n<h2 id=\"enabling-runtime-checks\">Enabling runtime checks<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/store/configuration/runtime-checks#enabling-runtime-checks\"><i class=\"material-icons\">link</i></a></h2>\n<p>It's possible to turn on the runtime checks one by one. To do so, you must enable them while providing the root store. Use the <code>runtimeChecks</code> property on the root store's config object. For each runtime check you can toggle the check with a <code>boolean</code>, <code>true</code> to enable the check, <code>false</code> to disable the check.</p>\n<code-example language=\"ts\">\n@NgModule({\n  imports: [\n    StoreModule.forRoot(reducers, {\n      runtimeChecks: {\n        strictImmutability: true,\n        strictStateSerializability: true,\n        strictActionSerializability: true,\n      },\n    }),\n  ],\n})\nexport class AppModule {}\n</code-example>\n<h3 id=\"strictimmutability\">strictImmutability<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/store/configuration/runtime-checks#strictimmutability\"><i class=\"material-icons\">link</i></a></h3>\n<p>The number one rule of NgRx, immutability. This <code>strictImmutability</code> check verifies if a developer tries to modify the state object or an action. This check is important to be able to work with the state in a predictable way, it should always be possible to recreate the state.</p>\n<p>Example violation of the rule:</p>\n<code-example language=\"ts\">\nfunction reducer(<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> = initialState, action: <a href=\"api/store/Action\" class=\"code-anchor\">Action</a>) {\n  switch (action.type) {\n    case '[Todo List] <a href=\"api/data/ChangeSetOperation#Add\" class=\"code-anchor\">Add</a> new todo':\n      // vialation 1: we assign a new <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a> to `todoInput` directly\n      state.todoInput = ''\n      // vialotion 2: `push` modifies the array\n      state.todos.push(action.payload)\n      return <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>\n\n    default:\n      return <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>\n  }\n}\n</code-example>\n<p>To fix the above violation, a new reference to the state has to be created:</p>\n<code-example language=\"ts\">\nfunction reducer(<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> = initialState, action: <a href=\"api/store/Action\" class=\"code-anchor\">Action</a>) {\n  switch (action.type) {\n    case '[Todo List] <a href=\"api/data/ChangeSetOperation#Add\" class=\"code-anchor\">Add</a> new todo':\n      return {\n        ...state,\n        todoInput: '',\n        todos: [...state.todos, action.payload]\n      }\n\n    default:\n      return <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>\n  }\n}\n</code-example>\n<h3 id=\"strictstateserializability\">strictStateSerializability<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/store/configuration/runtime-checks#strictstateserializability\"><i class=\"material-icons\">link</i></a></h3>\n<p>This check verifies if the state is serializable. A serializable state is important to be able to persist the current state to be able to rehydrate the state in the future.</p>\n<p>Example violation of the rule:</p>\n<code-example language=\"ts\">\nfunction reducer(<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> = initialState, action: <a href=\"api/store/Action\" class=\"code-anchor\">Action</a>) {\n  switch (action.type) {\n    case '[Todo List] Complete todo':\n      return {\n        ...state,\n        todos: {\n          ...state.todos,\n          [payload.id]: {\n            ...state.todos[payload.id],\n            // Vialation, Date is not seriazable\n            completedOn: new Date(),\n          },\n        },\n      }\n\n    default:\n      return <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>\n  }\n}\n</code-example>\n<p>As a fix of the above violation the <code>Date</code> object must be made serializable:</p>\n<code-example language=\"ts\">\nfunction reducer(<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> = initialState, action: <a href=\"api/store/Action\" class=\"code-anchor\">Action</a>) {\n  switch (action.type) {\n    case '[Todo List] Complete todo':\n      return {\n        ...state,\n        todos: {\n          ...state.todos,\n          [payload.id]: {\n            ...state.todos[payload.id],\n            completedOn: new Date().toJSON(),\n          },\n        },\n      }\n\n    default:\n      return <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>\n  }\n}\n</code-example>\n<h3 id=\"strictactionserializability\">strictActionSerializability<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/store/configuration/runtime-checks#strictactionserializability\"><i class=\"material-icons\">link</i></a></h3>\n<p>The <code>strictActionSerializability</code> check resembles <code>strictStateSerializability</code> but as the name says, it verifies if the action is serializable. An action must be serializable to be replayed, this can be helpful during development while using the Redux DevTools and in production to be able to debug errors.</p>\n<p>Example violation of the rule:</p>\n<code-example language=\"ts\">\nconst createTodo = <a href=\"api/store/createAction\" class=\"code-anchor\">createAction</a>('[Todo List] <a href=\"api/data/ChangeSetOperation#Add\" class=\"code-anchor\">Add</a> new todo', (todo) => ({\n  todo,\n  // Violation, a function is not serializable\n  logTodo: () => {\n    console.log(todo)\n  },\n}))\n</code-example>\n<p>The fix for this violation is to not add functions on actions, as a replacement a function can be created:</p>\n<code-example language=\"ts\">\nconst createTodo = <a href=\"api/store/createAction\" class=\"code-anchor\">createAction</a>('[Todo List] <a href=\"api/data/ChangeSetOperation#Add\" class=\"code-anchor\">Add</a> new todo', (todo) => todo)\n\nfunction logTodo (todo: Todo) {\n  console.log(todo);\n}\n</code-example>\n\n</div>\n\n<!-- links to this doc:\n-->\n<!-- links from this doc:\n - api/data/ChangeSetOperation#Add\n - api/store-devtools/StoreDevtools#state\n - api/store/Action\n - api/store/createAction\n - api/store/testing/MockSelector#value\n - guide/store/configuration/runtime-checks#enabling-runtime-checks\n - guide/store/configuration/runtime-checks#runtime-checks\n - guide/store/configuration/runtime-checks#strictactionserializability\n - guide/store/configuration/runtime-checks#strictimmutability\n - guide/store/configuration/runtime-checks#strictstateserializability\n - https://github.com/ngrx/platform/edit/master/projects/ngrx.io/content/guide/store/configuration/runtime-checks.md?message=docs%3A%20describe%20your%20change...\n-->"
}