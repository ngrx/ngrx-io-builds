{
  "id": "guide/component-store/usage",
  "title": "Usage",
  "contents": "\n\n\n  <div class=\"github-links\">\n    <a href=\"https://github.com/ngrx/platform/edit/master/projects/ngrx.io/content/guide/component-store/usage.md?message=docs%3A%20describe%20your%20change...\" aria-label=\"Suggest Edits\" title=\"Suggest Edits\"><i class=\"material-icons\" aria-hidden=\"true\" role=\"img\">mode_edit</i></a>\n  </div>\n\n\n<div class=\"content\">\n<h1 id=\"usage\">Usage<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#usage\"><i class=\"material-icons\">link</i></a></h1>\n<h2 id=\"types-of-state\">Types of State<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#types-of-state\"><i class=\"material-icons\">link</i></a></h2>\n<p>There are multiple types of state that exist in the application, and state management libraries are there to help manage/synchronize/update them. The topic of which one to choose, ComponentStore or the Global Store, or maybe both would be helpful, is described at <a href=\"guide/component-store/comparison\">ComponentStore vs Store</a> section.</p>\n<p>The types of state that developers typically deal with in applications are:</p>\n<ul>\n<li><strong>Server/Backend(s) State</strong>. This is the ultimate source of truth of all the data.</li>\n<li><strong>Persisted State</strong>. The \"snapshots\" of backend data transferred <em>to</em> and <em>from</em> application. E.g. Movies data passed as a JSON response, or user's rating for a particular Movie passed as an update request.</li>\n<li><strong>URL State</strong>. This is the state of the URL itself. Depending on which URL the user navigates to, the app would open specific pages and thus might request for <em>Persisted State</em>.</li>\n<li><strong>Client State</strong>. The state within the application that is not persisted to the backend. E.g. The info about which Tab is open in the application.</li>\n<li><strong>Local UI State</strong>. The state within a component itself. E.g. <code>isEnabled</code> toggle state of Toggle Component.</li>\n</ul>\n<figure>\n  <img src=\"generated/images/guide/component-store/types-of-state.png\" alt=\"Types of state in a typical SPA\" width=\"100%\" height=\"100%\">\n</figure>\n<p>There are more types of states, but these are the most important ones in the context of state management.</p>\n<div class=\"alert is-important\">\n<p>Synchronizing these states is one of the most complex tasks that developers have to solve.</p>\n</div>\n<p>Here is a small example to demonstrate how even a simple task might involve all of them:</p>\n<ol>\n<li>The user opens the page at a specific URL, \"<a href=\"https://www.TheBestMoviesOfAllTimeEver.com/favorites%22\">https://www.TheBestMoviesOfAllTimeEver.com/favorites\"</a>. That changes the <strong><em>URL State</em></strong>. </li>\n<li>The URL has a path for a specific tab, \"favorites\". That selection becomes part of the <strong><em>Client State</em></strong>. </li>\n<li>This results in API calls to the backend to get the data of the movies that the user marked as \"favorites\". We receive a snapshot of <strong><em>Persisted State</em></strong>.</li>\n<li>The Toggle Component that lives next to the <em>\"is favorite\"</em> label is turned ON. The \"ON\" state is derived from the data that the application received and passed to the Toggle Component through <code>@Input() isEnabled: boolean</code>. The component itself is not aware of <em>Persisted State</em> or what it even means to be ON in the context of the rest of the application. All it knows is that it needs to be visually displayed as ON. The <code>isEnabled</code> state is <strong><em>Local UI State</em></strong>.</li>\n<li>The user might decide that this movie is no longer their favorite and would click the Toggle button to turn it OFF. The <em>Local UI State</em> of the component is then changed, the <code>@Output() <a href=\"api/data/UpdateResponseData#changed\" class=\"code-anchor\">changed</a></code> event is emitted and picked up by a container component which would then call the backend to update the <em>Persisted State</em>.</li>\n</ol>\n<p>This was a very simple example. Typically developers have to solve many problems that are more interconnected. What if the user is not logged in? Should we wait until the new favorite state is persisted to the backend and only then show disabled state or should we do this optimistically? and so on.</p>\n<div class=\"alert is-helpful\">\n<p>Understanding these types of state helps us define our usage of ComponentStore.</p>\n</div>\n<h2 id=\"use-case-1-local-ui-state\">Use Case 1: Local UI State<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#use-case-1-local-ui-state\"><i class=\"material-icons\">link</i></a></h2>\n<h3 id=\"example-1-componentstore-as-part-of-the-component\">Example 1: ComponentStore as part of the component<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#example-1-componentstore-as-part-of-the-component\"><i class=\"material-icons\">link</i></a></h3>\n<p>The simplest example usage of <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> is <strong>reactive <em>Local UI State</em></strong>.</p>\n<div class=\"callout is-helpful\">\n<header>A note about component reactivity</header>\n<p>One of the ways to improve the performance of the application is to use the <code>OnPush</code> change detection strategy. However, contrary to the popular belief, we do not always need to tell Angular's change detection to <code>markForCheck()</code> or <code>detectChanges()</code> (or the Angular Ivy alternatives). As pointed out in <a href=\"https://indepth.dev/the-last-guide-for-angular-change-detection-youll-ever-need/\">this article on change detection</a>, if the event originates from the component itself, the component will be dirty checked.\nThis means that common presentational (aka dumb) components that interact with the rest of the application with Input(s)/Output(s) do not have to be overcomplicated with reactive state, even though we did it to the Toggle Component mentioned above.</p>\n</div>\n<p>Having said that, in most cases making <em>Local UI State</em> <strong>reactive</strong> is beneficial:</p>\n<ul>\n<li>For Zoneless application, the <code>async</code> pipe can easily be substituted with a Zoneless alternative such as the <a href=\"guide/component/push\"><code>ngrxPush</code> pipe</a></li>\n<li>For components with non-trivial business logic, reactivity can organize the state better by clearly separating actual state from derived values and identifying side-effects.</li>\n</ul>\n<div class=\"alert is-helpful\">\n<p>ComponentStore is not the only reactive <em>Local UI State</em> holder - sometimes <code>FormControl</code>s are good enough. They contain the state and they have reactive APIs.</p>\n</div>\n<p>Here's the simplified <code>SlideToggleComponent</code> example which uses <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> for <em>Local UI State</em>. In this example, the <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> is provided directly by the component itself, which might not be the best choice for most of the use cases of <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code>. Instead, consider a service that <code>extends <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code>.</p>\n<div class=\"alert is-helpful\">\n<p>You can see the full example at StackBlitz: <live-example name=\"component-store-slide-toggle\"></live-example></p>\n</div>\n<code-tabs linenums=\"true\">\n  <code-pane header=\"src/app/slide-toggle.component.ts\" path=\"component-store-slide-toggle/src/app/slide-toggle.component.ts\">\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> {\n  Component,\n  Input,\n  ChangeDetectionStrategy,\n  Output,\n  ViewEncapsulation,\n} from '@angular/core';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a> } from '@ngrx/component-store';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { tap } from 'rxjs/operators';\n\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> interface SlideToggleState {\n  checked: boolean;\n}\n\n/** Change event object emitted by a SlideToggleComponent. */\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> interface MatSlideToggleChange {\n  /** The source MatSlideToggle of the event. */\n  readonly source: SlideToggleComponent;\n  /** The new `checked` <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a> of the MatSlideToggle. */\n  readonly checked: boolean;\n}\n\n@Component({\n  <a href=\"api/store/testing/MockSelector#selector\" class=\"code-anchor\">selector</a>: 'mat-slide-toggle',\n  templateUrl: 'slide-toggle.html',\n  styleUrls: ['./slide-toggle.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [<a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>],\n})\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> class SlideToggleComponent {\n  @Input() set checked(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: boolean) {\n    this.setChecked(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n  }\n  // Observable&#x3C;MatSlideToggleChange> used instead of EventEmitter\n  @Output() readonly change = this.componentStore.select((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => ({\n    source: this,\n    checked: state.checked,\n  }));\n\n  readonly setChecked = this.componentStore.updater(\n    (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: boolean) => ({ ...state, checked: <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a> })\n  );\n\n  // ViewModel for the component\n  readonly vm$ = this.componentStore.select((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => ({\n    checked: state.checked,\n  }));\n\n  constructor(\n    private readonly componentStore: <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>&#x3C;SlideToggleState>\n  ) {\n    // set defaults\n    this.componentStore.setState({\n      checked: false,\n    });\n  }\n\n  onChangeEvent = this.componentStore.effect&#x3C;{\n    source: Event;\n    checked: boolean;\n  }>((event$) => {\n    return event$.pipe(\n      tap&#x3C;{ source: Event; checked: boolean }>((event) => {\n        event.source.stopPropagation();\n        this.setChecked(!event.checked);\n      })\n    );\n  });\n}\n\n\n</code-pane>\n  <code-pane header=\"src/app/slide-toggle.html\" path=\"component-store-slide-toggle/src/app/slide-toggle.html\">\n&#x3C;div *ngIf=\"vm$ | async as vm\" class=\"mat-mdc-slide-toggle mat-accent\">\n  &#x3C;div class=\"mdc-form-field mdc-form-field--align-end\">\n    &#x3C;button\n      class=\"mdc-switch\"\n      role=\"switch\"\n      type=\"button\"\n      [class.mdc-switch--selected]=\"vm.checked\"\n      [class.mdc-switch--unselected]=\"!vm.checked\"\n      [class.mdc-switch--checked]=\"vm.checked\"\n      (click)=\"onChangeEvent({ source: $event, checked: vm.checked })\"\n      #switch\n    >\n      &#x3C;div class=\"mdc-switch__track\">&#x3C;/div>\n      &#x3C;div class=\"mdc-switch__handle-track\">\n        &#x3C;div class=\"mdc-switch__handle\">\n          &#x3C;div class=\"mdc-switch__shadow\">\n            &#x3C;div class=\"mdc-elevation-overlay\">&#x3C;/div>\n          &#x3C;/div>\n          &#x3C;div class=\"mdc-switch__ripple\">\n            &#x3C;div\n              class=\"mat-mdc-slide-toggle-ripple mat-mdc-focus-indicator\"\n              mat-ripple\n              [matRippleTrigger]=\"switch\"\n              [matRippleCentered]=\"true\"\n            >&#x3C;/div>\n          &#x3C;/div>\n          &#x3C;div class=\"mdc-switch__icons\">\n            &#x3C;svg\n              class=\"mdc-switch__icon mdc-switch__icon--on\"\n              viewBox=\"0 0 24 24\"\n            >\n              &#x3C;path\n                d=\"M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z\"\n              />\n            &#x3C;/svg>\n            &#x3C;svg\n              class=\"mdc-switch__icon mdc-switch__icon--off\"\n              viewBox=\"0 0 24 24\"\n            >\n              &#x3C;path d=\"M20 13H4v-2h16v2z\" />\n            &#x3C;/svg>\n          &#x3C;/div>\n        &#x3C;/div>\n      &#x3C;/div>\n    &#x3C;/button>\n\n    &#x3C;label>\n      &#x3C;ng-content>&#x3C;/ng-content>\n    &#x3C;/label>\n  &#x3C;/div>\n&#x3C;/div>\n\n\n</code-pane>\n</code-tabs>\n<p>Below are the steps of integrating <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> into a component.</p>\n<h4 id=\"step-1-setting-up\">Step 1. Setting up<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#step-1-setting-up\"><i class=\"material-icons\">link</i></a></h4>\n<p>First, the state for the component needs to be identified. In <code>SlideToggleComponent</code> only the state of whether the toggle is turned ON or OFF is stored.</p>\n<code-example header=\"src/app/slide-toggle.component.ts\" path=\"component-store-slide-toggle/src/app/slide-toggle.component.ts\" region=\"state\">\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> interface SlideToggleState {\n  checked: boolean;\n}\n\n</code-example>\n<p>Then we need to provide <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> in the component's providers, so that each new instance of <code>SlideToggleComponent</code> has its own <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code>. It also has to be injected into the constructor.</p>\n<div class=\"alert is-important\">\n<p>In this example <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> is provided directly in the component. This works for simple cases, however in real-world cases it is recommended to create a separate Service, for example <code>SlideToggleStore</code>, that would extend <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> and would contain all the business logic. This new Service is then provided in the component. See examples below.</p>\n</div>\n<code-example linenums=\"false\" header=\"src/app/slide-toggle.component.ts\" path=\"component-store-slide-toggle/src/app/slide-toggle.component.ts\" region=\"providers\">\n@Component({\n  <a href=\"api/store/testing/MockSelector#selector\" class=\"code-anchor\">selector</a>: 'mat-slide-toggle',\n  templateUrl: 'slide-toggle.html',\n/* . . . */\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [<a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>],\n})\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> class SlideToggleComponent {\n/* . . . */\n  constructor(\n    private readonly componentStore: <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>&#x3C;SlideToggleState>\n  ) {\n/* . . . */\n}\n\n</code-example>\n<p>Next, the default state for the component needs to be set. It could be done lazily, however it needs to be done before any of <code>updater</code>s are executed, because they rely on the state to be present and would throw an error if the state is not initialized by the time they are invoked.</p>\n<p>State is initialized by calling <code>setState</code> and passing an object that matches the interface of <code>SlideToggleState</code>.</p>\n<div class=\"alert is-important\">\n<p><code>setState</code> could be called with either an object or a callback.</p>\n<p>When it is called with an object, state is initialized or reset to that object.</p>\n<p>When it is called with a callback, the state is updated.</p>\n</div>\n<code-example header=\"src/app/slide-toggle.component.ts\" path=\"component-store-slide-toggle/src/app/slide-toggle.component.ts\" region=\"init\">\nconstructor(\n  private readonly componentStore: <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>&#x3C;SlideToggleState>\n) {\n  // set defaults\n  this.componentStore.setState({\n    checked: false,\n  });\n}\n\n</code-example>\n<h4 id=\"step-2-updating-state\">Step 2. Updating state<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#step-2-updating-state\"><i class=\"material-icons\">link</i></a></h4>\n<p>In the slide-toggle example, the state is updated either through <code>@Input</code> or by a user interaction, which results in a <code>onChangeEvent($event)</code> call in the template. Both of them change the same piece of state - <code>checked: boolean</code>, thus we have the <code>setChecked</code> updater that is reused in two places. This updater describes <strong>HOW</strong> the state changes - it takes the current state and a value and returns the new state.</p>\n<p><code>@Input</code> here is a setter function that passes the value to the <code>setChecked</code> updater.</p>\n<p>When a user clicks the toggle (triggering a 'change' event), instead of calling the same updater directly, the <code>onChangeEvent</code> effect is called. This is done because we also need to have the side-effect of <code>event.source.stopPropagation</code> to prevent this event from bubbling up (slide-toggle output event in named 'change' as well) and only after that the <code>setChecked</code> updater is called with the value of the input element.</p>\n<code-example linenums=\"false\" header=\"src/app/slide-toggle.component.ts\" path=\"component-store-slide-toggle/src/app/slide-toggle.component.ts\" region=\"updater\">\n  @Input() set checked(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: boolean) {\n    this.setChecked(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n  }\n/* . . . */\n  readonly setChecked = this.componentStore.updater(\n    (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: boolean) => ({ ...state, checked: <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a> })\n  );\n/* . . . */\n  onChangeEvent = this.componentStore.effect&#x3C;{\n    source: Event;\n    checked: boolean;\n  }>((event$) => {\n    return event$.pipe(\n      tap&#x3C;{ source: Event; checked: boolean }>((event) => {\n        event.source.stopPropagation();\n        this.setChecked(!event.checked);\n      })\n    );\n  });\n\n</code-example>\n<h4 id=\"step-3-reading-the-state\">Step 3. Reading the state<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#step-3-reading-the-state\"><i class=\"material-icons\">link</i></a></h4>\n<p>Finally, the state is aggregated with selectors into two properties:</p>\n<ul>\n<li><code>vm$</code> property collects all the data needed for the template - this is the <em>ViewModel</em> of <code>SlideToggleComponent</code>. </li>\n<li><code>change</code> is the <code>@Output</code> of <code>SlideToggleComponent</code>. Instead of creating an <code>EventEmitter</code>, here the output is connected to the Observable source directly.</li>\n</ul>\n<code-example header=\"src/app/slide-toggle.component.ts\" path=\"component-store-slide-toggle/src/app/slide-toggle.component.ts\" region=\"selector\">\n  // Observable&#x3C;MatSlideToggleChange> used instead of EventEmitter\n  @Output() readonly change = this.componentStore.select((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => ({\n    source: this,\n    checked: state.checked,\n  }));\n/* . . . */\n  // ViewModel for the component\n  readonly vm$ = this.componentStore.select((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => ({\n    checked: state.checked,\n  }));\n\n</code-example>\n<p>This example does not have a lot of business logic, however it is still fully reactive.</p>\n<h3 id=\"example-2-service-extending-componentstore\">Example 2: Service extending ComponentStore<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#example-2-service-extending-componentstore\"><i class=\"material-icons\">link</i></a></h3>\n<p><code>SlideToggleComponent</code> is a fairly simple component and having <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> within the component itself is still manageable. When components takes more Inputs and/or has more events within its template, it becomes larger and harder to read/maintain.</p>\n<p>Extracting the business logic of a component into a separate Service also helps reduce the cognitive load while reading the components code.</p>\n<div class=\"alert is-important\">\n<p>A Service that extends ComponentStore and contains business logic of the component brings many advantages. <strong>This is also the recommended usage of ComponentStore</strong>.</p>\n</div>\n<p><code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> was designed with such an approach in mind. The main APIs of <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> (<code>updater</code>, <code><a href=\"api/store/select\" class=\"code-anchor\">select</a></code> and <code><a href=\"api/effects/EffectNotification#effect\" class=\"code-anchor\">effect</a></code>) are meant to wrap the <strong>HOW</strong> state is changed, extracted or effected, and then called with arguments.</p>\n<p>Below are the two examples of a re-implemented <a href=\"https://material.angular.io/components/paginator/overview\">Paginator component</a> from Angular Material (a UI component library). These re-implementations are very functionally close alternatives.</p>\n<p>Here's the source code of the <a href=\"https://github.com/angular/components/blob/23d3c216c65b327e0acfb48b53302b8fda326e7f/src/material/paginator/paginator.ts#L112\">Material's paginator.ts</a> as a reference.</p>\n<p>What we can see is that while the <em>\"PaginatorComponent providing ComponentStore\"</em> example already makes the component a lot smaller, reactive, removes <code>this._changeDetectorRef.markForCheck()</code> and organizes it into distinct \"read\"/\"write\"/\"effect\" buckets, it still could be hard to read. The <em>\"PaginatorComponent with PaginatorStore\"</em> example adds readability and further improves the testability of behaviors and business logic.</p>\n<div class=\"alert is-helpful\">\n<p>You can see the examples at StackBlitz:</p>\n<ul>\n<li>\"PaginatorComponent providing ComponentStore\" <live-example name=\"component-store-paginator\" nodownload=\"\"></live-example></li>\n<li>\"PaginatorComponent with PaginatorStore Service\" <live-example name=\"component-store-paginator-service\" nodownload=\"\"></live-example></li>\n</ul>\n</div>\n<code-tabs linenums=\"true\">\n  <code-pane header=\"PaginatorComponent with PaginatorStore Service\" path=\"component-store-paginator-service/src/app/paginator.component.ts\">\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> {\n  Component,\n  Input,\n  ChangeDetectionStrategy,\n  Output,\n  ViewEncapsulation,\n} from '@angular/core';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { PaginatorStore } from './paginator.store';\n\n@Component({\n  <a href=\"api/store/testing/MockSelector#selector\" class=\"code-anchor\">selector</a>: 'paginator',\n  templateUrl: 'paginator.html',\n  host: {\n    'class': 'mat-paginator',\n  },\n  styleUrls: ['./paginator.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [PaginatorStore],\n})\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> class PaginatorComponent {\n  @Input() set pageIndex(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n    this.paginatorStore.setPageIndex(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n  }\n\n  @Input() set length(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n    this.paginatorStore.setLength(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n  }\n\n  @Input() set pageSize(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n    this.paginatorStore.setPageSize(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n  }\n\n  @Input() set pageSizeOptions(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: readonly number[]) {\n    this.paginatorStore.setPageSizeOptions(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n  }\n\n  // Outputing the event directly from the page$ Observable&#x3C;PageEvent> property.\n  /** Event emitted when the paginator changes the page size or page index. */\n  @Output() readonly page = this.paginatorStore.page$;\n\n  // ViewModel for the PaginatorComponent\n  readonly vm$ = this.paginatorStore.vm$;\n\n  constructor(private readonly paginatorStore: PaginatorStore) {}\n\n  changePageSize(newPageSize: number) {\n    this.paginatorStore.changePageSize(newPageSize);\n  }\n  nextPage() {\n    this.paginatorStore.nextPage();\n  }\n  firstPage() {\n    this.paginatorStore.firstPage();\n  }\n  previousPage() {\n    this.paginatorStore.previousPage();\n  }\n  lastPage() {\n    this.paginatorStore.lastPage();\n  }\n}\n\n\n</code-pane>\n  <code-pane header=\"PaginatorComponent providing ComponentStore\" path=\"component-store-paginator/src/app/paginator.component.ts\">\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> {\n  Component,\n  Input,\n  ChangeDetectionStrategy,\n  Output,\n  EventEmitter,\n  ViewEncapsulation,\n} from '@angular/core';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a> } from '@ngrx/component-store';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { <a href=\"api/data/EntityCollection#filter\" class=\"code-anchor\">filter</a>, tap, withLatestFrom, map, pairwise, skip } from 'rxjs/operators';\n\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> interface PaginatorState {\n  /** The current page index. */\n  pageIndex: number;\n  /** The current page size */\n  pageSize: number;\n  /** The current total number of items being paged */\n  length: number;\n  /** The set of provided page size <a href=\"api/data/RequestData#options\" class=\"code-anchor\">options</a> to display to the user. */\n  pageSizeOptions: ReadonlySet&#x3C;number>;\n}\n\n/**\n * Change event object that is emitted when the user selects a\n * different page size or navigates to another page.\n */\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> interface PageEvent\n  extends Pick&#x3C;PaginatorState, 'pageIndex' | 'pageSize' | 'length'> {\n  /**\n   * Index of the page that was selected previously.\n   */\n  previousPageIndex?: number;\n}\n\n@Component({\n  <a href=\"api/store/testing/MockSelector#selector\" class=\"code-anchor\">selector</a>: 'paginator',\n  templateUrl: 'paginator.html',\n  host: {\n    'class': 'mat-paginator',\n  },\n  styleUrls: ['./paginator.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [<a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>],\n})\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> class PaginatorComponent {\n  @Input() set pageIndex(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n    this.setPageIndex(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n  }\n\n  @Input() set length(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n    this.componentStore.setState((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => ({\n      ...state,\n      length: Number(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>) || 0,\n    }));\n  }\n\n  @Input() set pageSize(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n    this.componentStore.setState((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => ({\n      ...state,\n      pageSize: Number(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>) || 0,\n    }));\n  }\n\n  @Input() set pageSizeOptions(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: readonly number[]) {\n    this.componentStore.setState((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => {\n      // Making sure that the pageSize is included and sorted\n      const pageSizeOptions = new Set&#x3C;number>(\n        [...value, state.pageSize].sort((a, b) => a - b)\n      );\n      return { ...state, pageSizeOptions };\n    });\n  }\n\n  private readonly pageIndexChanges$ = this.componentStore.state$.pipe(\n    // map instead of <a href=\"api/store/select\" class=\"code-anchor\">select</a>, so that non-distinct <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a> could go through\n    map((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => state.pageIndex),\n    pairwise()\n  );\n\n  @Output() readonly page = this.componentStore.select(\n    // first Observable ðŸ‘‡\n    this.pageIndexChanges$,\n    // second Observable ðŸ‘‡\n    this.componentStore.select((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => [state.pageSize, state.length]),\n    // Now combining the results from both of these Observables into a PageEvent object\n    ([previousPageIndex, pageIndex], [pageSize, length]) => ({\n      pageIndex,\n      previousPageIndex,\n      pageSize,\n      length,\n    }),\n    // <a href=\"api/component-store/SelectConfig#debounce\" class=\"code-anchor\">debounce</a>, so that we let the <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> \"settle\" before emitting a <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>\n    { <a href=\"api/component-store/SelectConfig#debounce\" class=\"code-anchor\">debounce</a>: true }\n  ).pipe(\n    // Skip the emission of the initial <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> values\n    skip(1)\n  );\n\n  // *********** Updaters *********** //\n\n  readonly setPageIndex = this.componentStore.updater(\n    (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) => ({\n      ...state,\n      pageIndex: Number(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>) || 0,\n    })\n  );\n\n  readonly changePageSize = this.componentStore.updater(\n    (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, newPageSize: number) => {\n      const startIndex = state.pageIndex * state.pageSize;\n      return {\n        ...state,\n        pageSize: newPageSize,\n        pageIndex: Math.floor(startIndex / newPageSize),\n      };\n    }\n  );\n\n  // *********** Selectors *********** //\n\n  readonly hasPreviousPage$ = this.componentStore.select(\n    ({ pageIndex, pageSize }) => pageIndex >= 1 &#x26;&#x26; pageSize != 0\n  );\n\n  readonly numberOfPages$ = this.componentStore.select(\n    ({ pageSize, length }) => {\n      if (!pageSize) return 0;\n      return Math.ceil(length / pageSize);\n    }\n  );\n\n  readonly hasNextPage$ = this.componentStore.select(\n    this.componentStore.state$,\n    this.numberOfPages$,\n    ({ pageIndex, pageSize }, numberOfPages) => {\n      const maxPageIndex = numberOfPages - 1;\n      return pageIndex &#x3C; maxPageIndex &#x26;&#x26; pageSize != 0;\n    }\n  );\n\n  readonly rangeLabel$ = this.componentStore.select(\n    ({ pageIndex, pageSize, length }) => {\n      if (length == 0 || pageSize == 0) {\n        return `0 of ${length}`;\n      }\n      length = Math.max(length, 0);\n\n      const startIndex = pageIndex * pageSize;\n\n      // If the start index exceeds the list length, do not try and fix the end index to the end.\n      const endIndex =\n        startIndex &#x3C; length\n          ? Math.min(startIndex + pageSize, length)\n          : startIndex + pageSize;\n\n      return `${startIndex + 1} â€“ ${endIndex} of ${length}`;\n    }\n  );\n\n  // ViewModel of Paginator component\n  readonly vm$ = this.componentStore.select(\n    this.componentStore.state$,\n    this.hasPreviousPage$,\n    this.hasNextPage$,\n    this.rangeLabel$,\n    (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, hasPreviousPage, hasNextPage, rangeLabel) => ({\n      pageSize: state.pageSize,\n      pageSizeOptions: Array.from(state.pageSizeOptions),\n      pageIndex: state.pageIndex,\n      hasPreviousPage,\n      hasNextPage,\n      rangeLabel,\n    })\n  );\n\n  // *********** Effects *********** //\n\n  readonly lastPage = this.componentStore.effect((trigger$) => {\n    return trigger$.pipe(\n      withLatestFrom(this.numberOfPages$),\n      tap(([, numberOfPages]) => {\n        this.setPageIndex(numberOfPages - 1);\n      })\n    );\n  });\n\n  constructor(private readonly componentStore: <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>&#x3C;PaginatorState>) {\n    // set defaults\n    this.componentStore.setState({\n      pageIndex: 0,\n      pageSize: 50,\n      length: 0,\n      pageSizeOptions: new Set&#x3C;number>([50]),\n    });\n  }\n}\n\n\n</code-pane>\n  <code-pane header=\"src/app/paginator.store.ts\" path=\"component-store-paginator-service/src/app/paginator.store.ts\">\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { Injectable } from '@angular/core';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a> } from '@ngrx/component-store';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { <a href=\"api/data/EntityCollection#filter\" class=\"code-anchor\">filter</a>, tap, map, withLatestFrom, pairwise, skip } from 'rxjs/operators';\n<a href=\"api/store-devtools/DevToolsFeatureOptions#import\" class=\"code-anchor\">import</a> { Observable } from 'rxjs';\n\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> interface PaginatorState {\n  /** The current page index. */\n  pageIndex: number;\n  /** The current page size */\n  pageSize: number;\n  /** The current total number of items being paged */\n  length: number;\n  /** The set of provided page size <a href=\"api/data/RequestData#options\" class=\"code-anchor\">options</a> to display to the user. */\n  pageSizeOptions: ReadonlySet&#x3C;number>;\n}\n\n/**\n * Change event object that is emitted when the user selects a\n * different page size or navigates to another page.\n */\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> interface PageEvent\n  extends Pick&#x3C;PaginatorState, 'pageIndex' | 'pageSize' | 'length'> {\n  /**\n   * Index of the page that was selected previously.\n   */\n  previousPageIndex?: number;\n}\n\n@Injectable()\n<a href=\"api/store-devtools/DevToolsFeatureOptions#export\" class=\"code-anchor\">export</a> class PaginatorStore extends <a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a>&#x3C;PaginatorState> {\n  constructor() {\n    // set defaults\n    super({\n      pageIndex: 0,\n      pageSize: 50,\n      length: 0,\n      pageSizeOptions: new Set&#x3C;number>([50]),\n    });\n  }\n  // *********** Updaters *********** //\n\n  readonly setPageIndex = this.updater((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) => ({\n    ...state,\n    pageIndex: Number(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>) || 0,\n  }));\n\n  readonly setPageSize = this.updater((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) => ({\n    ...state,\n    pageSize: Number(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>) || 0,\n  }));\n\n  readonly setLength = this.updater((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) => ({\n    ...state,\n    length: Number(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>) || 0,\n  }));\n\n  readonly setPageSizeOptions = this.updater(\n    (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: readonly number[]) => {\n      // Making sure that the pageSize is included and sorted\n      const pageSizeOptions = new Set&#x3C;number>(\n        [...value, state.pageSize].sort((a, b) => a - b)\n      );\n      return { ...state, pageSizeOptions };\n    }\n  );\n\n  readonly changePageSize = this.updater((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, newPageSize: number) => {\n    const startIndex = state.pageIndex * state.pageSize;\n    return {\n      ...state,\n      pageSize: newPageSize,\n      pageIndex: Math.floor(startIndex / newPageSize),\n    };\n  });\n\n  // *********** Selectors *********** //\n\n  readonly hasPreviousPage$ = this.select(\n    ({ pageIndex, pageSize }) => pageIndex >= 1 &#x26;&#x26; pageSize != 0\n  );\n\n  readonly numberOfPages$ = this.select(({ pageSize, length }) => {\n    if (!pageSize) return 0;\n    return Math.ceil(length / pageSize);\n  });\n\n  readonly hasNextPage$ = this.select(\n    this.state$,\n    this.numberOfPages$,\n    ({ pageIndex, pageSize }, numberOfPages) => {\n      const maxPageIndex = numberOfPages - 1;\n      return pageIndex &#x3C; maxPageIndex &#x26;&#x26; pageSize != 0;\n    }\n  );\n\n  readonly rangeLabel$ = this.select(({ pageIndex, pageSize, length }) => {\n    if (length === 0 || pageSize === 0) return `0 of ${length}`;\n\n    length = Math.max(length, 0);\n    const startIndex = pageIndex * pageSize;\n\n    // If the start index exceeds the list length, do not try and fix the end index to the end.\n    const endIndex =\n      startIndex &#x3C; length\n        ? Math.min(startIndex + pageSize, length)\n        : startIndex + pageSize;\n\n    return `${startIndex + 1} â€“ ${endIndex} of ${length}`;\n  });\n\n  // ViewModel of Paginator component\n  readonly vm$ = this.select(\n    this.state$,\n    this.hasPreviousPage$,\n    this.hasNextPage$,\n    this.rangeLabel$,\n    (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, hasPreviousPage, hasNextPage, rangeLabel) => ({\n      pageSize: state.pageSize,\n      pageSizeOptions: Array.from(state.pageSizeOptions),\n      pageIndex: state.pageIndex,\n      hasPreviousPage,\n      hasNextPage,\n      rangeLabel,\n    })\n  );\n\n  private readonly pageIndexChanges$ = this.state$.pipe(\n    // map instead of <a href=\"api/store/select\" class=\"code-anchor\">select</a>, so that non-distinct <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a> could go through\n    map((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => state.pageIndex),\n    pairwise()\n  );\n\n  readonly page$: Observable&#x3C;PageEvent> = this.select(\n    // first Observable ðŸ‘‡\n    this.pageIndexChanges$,\n    // second Observable ðŸ‘‡\n    this.select((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => [state.pageSize, state.length]),\n    // Now combining the results from both of these Observables into a PageEvent object\n    ([previousPageIndex, pageIndex], [pageSize, length]) => ({\n      pageIndex,\n      previousPageIndex,\n      pageSize,\n      length,\n    }),\n    // <a href=\"api/component-store/SelectConfig#debounce\" class=\"code-anchor\">debounce</a>, so that we let the <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> \"settle\"\n    { <a href=\"api/component-store/SelectConfig#debounce\" class=\"code-anchor\">debounce</a>: true }\n  ).pipe(\n    // Skip the emission of the initial <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> values\n    skip(1)\n  );\n\n  readonly nextPage = this.effect((trigger$) => {\n    return trigger$.pipe(\n      withLatestFrom(this.hasNextPage$),\n      <a href=\"api/data/EntityCollection#filter\" class=\"code-anchor\">filter</a>(([, hasNextPage]) => hasNextPage),\n      tap(() => {\n        this.setPageIndex(this.get().pageIndex + 1);\n      })\n    );\n  });\n\n  readonly firstPage = this.effect((trigger$) => {\n    return trigger$.pipe(\n      withLatestFrom(this.hasPreviousPage$),\n      <a href=\"api/data/EntityCollection#filter\" class=\"code-anchor\">filter</a>(([, hasPreviousPage]) => hasPreviousPage),\n      tap(() => {\n        this.setPageIndex(0);\n      })\n    );\n  });\n\n  readonly previousPage = this.effect((trigger$) => {\n    return trigger$.pipe(\n      withLatestFrom(this.hasPreviousPage$),\n      <a href=\"api/data/EntityCollection#filter\" class=\"code-anchor\">filter</a>(([, hasPreviousPage]) => hasPreviousPage),\n      tap(() => {\n        this.setPageIndex(this.get().pageIndex - 1);\n      })\n    );\n  });\n\n  readonly lastPage = this.effect((trigger$) => {\n    return trigger$.pipe(\n      withLatestFrom(this.hasNextPage$, this.numberOfPages$),\n      <a href=\"api/data/EntityCollection#filter\" class=\"code-anchor\">filter</a>(([, hasNextPage]) => hasNextPage),\n      tap(([, , numberOfPages]) => {\n        this.setPageIndex(numberOfPages - 1);\n      })\n    );\n  });\n}\n\n\n</code-pane>\n</code-tabs>\n<h4 id=\"updating-the-state\">Updating the state<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#updating-the-state\"><i class=\"material-icons\">link</i></a></h4>\n<p>With <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> extracted into <code>PaginatorStore</code>, the developer is now using updaters and effects to update the state. <code>@Input</code> values are passed directly into <code>updater</code>s as their arguments.</p>\n<code-example header=\"src/app/paginator.store.ts\" path=\"component-store-paginator-service/src/app/paginator.component.ts\" region=\"inputs\">\n@Input() set pageIndex(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n  this.paginatorStore.setPageIndex(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n}\n\n@Input() set length(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n  this.paginatorStore.setLength(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n}\n\n@Input() set pageSize(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: string | number) {\n  this.paginatorStore.setPageSize(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n}\n\n@Input() set pageSizeOptions(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>: readonly number[]) {\n  this.paginatorStore.setPageSizeOptions(<a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a>);\n}\n\n</code-example>\n<p>  Not all <code>updater</code>s have to be called in the <code>@Input</code>. For example, <code>changePageSize</code> is called from the template. </p>\n<p>  Effects are used to perform additional validation and get extra information from sources with derived data (i.e. selectors).</p>\n<p>  <code-example header=\"src/app/paginator.store.ts\" path=\"component-store-paginator-service/src/app/paginator.component.ts\" region=\"updating-state\">\nchangePageSize(newPageSize: number) {\n  this.paginatorStore.changePageSize(newPageSize);\n}\nnextPage() {\n  this.paginatorStore.nextPage();\n}\nfirstPage() {\n  this.paginatorStore.firstPage();\n}\npreviousPage() {\n  this.paginatorStore.previousPage();\n}\nlastPage() {\n  this.paginatorStore.lastPage();\n}\n\n</code-example></p>\n<h4 id=\"reading-the-state\">Reading the state<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#reading-the-state\"><i class=\"material-icons\">link</i></a></h4>\n<p><code>PaginatorStore</code> exposes the two properties: <code>vm$</code> for an aggregated <em>ViewModel</em> to be used in the template and <code>page$</code> that would emit whenever data aggregated from a <code>PageEvent</code> changes.</p>\n<code-tabs>\n  <code-pane header=\"src/app/paginator.component.ts\" path=\"component-store-paginator-service/src/app/paginator.component.ts\" region=\"selectors\">\n// Outputing the event directly from the page$ Observable&#x3C;PageEvent> property.\n/** Event emitted when the paginator changes the page size or page index. */\n@Output() readonly page = this.paginatorStore.page$;\n\n// ViewModel for the PaginatorComponent\nreadonly vm$ = this.paginatorStore.vm$;\n\n</code-pane>\n  <code-pane header=\"src/app/paginator.store.ts\" path=\"component-store-paginator-service/src/app/paginator.store.ts\" region=\"selectors\">\n// ViewModel of Paginator component\nreadonly vm$ = this.select(\n  this.state$,\n  this.hasPreviousPage$,\n  this.hasNextPage$,\n  this.rangeLabel$,\n  (<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>, hasPreviousPage, hasNextPage, rangeLabel) => ({\n    pageSize: state.pageSize,\n    pageSizeOptions: Array.from(state.pageSizeOptions),\n    pageIndex: state.pageIndex,\n    hasPreviousPage,\n    hasNextPage,\n    rangeLabel,\n  })\n);\n\nprivate readonly pageIndexChanges$ = this.state$.pipe(\n  // map instead of <a href=\"api/store/select\" class=\"code-anchor\">select</a>, so that non-distinct <a href=\"api/store/testing/MockSelector#value\" class=\"code-anchor\">value</a> could go through\n  map((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => state.pageIndex),\n  pairwise()\n);\n\nreadonly page$: Observable&#x3C;PageEvent> = this.select(\n  // first Observable ðŸ‘‡\n  this.pageIndexChanges$,\n  // second Observable ðŸ‘‡\n  this.select((<a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a>) => [state.pageSize, state.length]),\n  // Now combining the results from both of these Observables into a PageEvent object\n  ([previousPageIndex, pageIndex], [pageSize, length]) => ({\n    pageIndex,\n    previousPageIndex,\n    pageSize,\n    length,\n  }),\n  // <a href=\"api/component-store/SelectConfig#debounce\" class=\"code-anchor\">debounce</a>, so that we let the <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> \"settle\"\n  { <a href=\"api/component-store/SelectConfig#debounce\" class=\"code-anchor\">debounce</a>: true }\n).pipe(\n  // Skip the emission of the initial <a href=\"api/store-devtools/StoreDevtools#state\" class=\"code-anchor\">state</a> values\n  skip(1)\n);\n\n</code-pane>\n</code-tabs>\n<div class=\"alert is-helpful\">\n<p><code>page$</code> would emit <code>PageEvent</code> when page size or page index changes, however in some cases updater would update both of these properties at the same time. To avoid \"intermediary\" emissions, <code>page$</code> selector is using <strong><code>{<a href=\"api/component-store/SelectConfig#debounce\" class=\"code-anchor\">debounce</a>: true}</code></strong> configuration. More about debouncing can be found in <a href=\"guide/component-store/read#debounce-selectors\">selector section</a>.</p>\n</div>\n<h3 id=\"local-ui-state-patterns\">Local UI State patterns<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/component-store/usage#local-ui-state-patterns\"><i class=\"material-icons\">link</i></a></h3>\n<p>Components that use <code><a href=\"api/component-store/ComponentStore\" class=\"code-anchor\">ComponentStore</a></code> for managing <strong>Local UI State</strong> are frequently calling <code>updater</code>s directly.</p>\n<p>Effects can also be used when:</p>\n<ul>\n<li>side effects are required (e.g. <code>event.stopPropagation()</code>)</li>\n<li>derived data (from selectors) is needed to influence the new state</li>\n<li>they are orchestrating a number of well-defined updaters</li>\n</ul>\n<p>The last point can sometimes be refactored into another <code>updater</code>. Use your best judgment.</p>\n<p><code>@Output()</code>s and derived data are <strong>reacting</strong> to these state changes and are generated using <code><a href=\"api/store/testing/MockSelector#selector\" class=\"code-anchor\">selector</a></code>s.</p>\n<p>A <em>ViewModel</em> for the component is also composed from <code><a href=\"api/store/testing/MockSelector#selector\" class=\"code-anchor\">selector</a></code>s.</p>\n\n</div>\n\n<!-- links to this doc:\n-->\n<!-- links from this doc:\n - api/component-store/ComponentStore\n - api/component-store/SelectConfig#debounce\n - api/data/EntityCollection#filter\n - api/data/RequestData#options\n - api/data/UpdateResponseData#changed\n - api/effects/EffectNotification#effect\n - api/store-devtools/DevToolsFeatureOptions#export\n - api/store-devtools/DevToolsFeatureOptions#import\n - api/store-devtools/StoreDevtools#state\n - api/store/select\n - api/store/testing/MockSelector#selector\n - api/store/testing/MockSelector#value\n - guide/component-store/comparison\n - guide/component-store/read#debounce-selectors\n - guide/component-store/usage#example-1-componentstore-as-part-of-the-component\n - guide/component-store/usage#example-2-service-extending-componentstore\n - guide/component-store/usage#local-ui-state-patterns\n - guide/component-store/usage#reading-the-state\n - guide/component-store/usage#step-1-setting-up\n - guide/component-store/usage#step-2-updating-state\n - guide/component-store/usage#step-3-reading-the-state\n - guide/component-store/usage#types-of-state\n - guide/component-store/usage#updating-the-state\n - guide/component-store/usage#usage\n - guide/component-store/usage#use-case-1-local-ui-state\n - guide/component/push\n - https://github.com/angular/components/blob/23d3c216c65b327e0acfb48b53302b8fda326e7f/src/material/paginator/paginator.ts#L112\n - https://github.com/ngrx/platform/edit/master/projects/ngrx.io/content/guide/component-store/usage.md?message=docs%3A%20describe%20your%20change...\n - https://indepth.dev/the-last-guide-for-angular-change-detection-youll-ever-need/\n - https://material.angular.io/components/paginator/overview\n - https://www.TheBestMoviesOfAllTimeEver.com/favorites%22\n-->"
}