{"version":3,"sources":["./node_modules/rxjs/_esm5/internal/observable/SubscribeOnObservable.js","./node_modules/rxjs/_esm5/internal/operators/subscribeOn.js","./src/app/custom-elements/toc/toc.component.html","./src/app/custom-elements/toc/toc.component.ts","./src/app/custom-elements/toc/toc.module.ts"],"names":["_super","SubscribeOnObservable","source","delayTime","scheduler","asap","_this","call","this","isNumeric","schedule","create","delay","dispatch","arg","add","subscribe","subscriber","prototype","_subscribe","Observable","SubscribeOnOperator","title","scrollService","elementRef","tocService","activeIndex","type","isCollapsed","isEmbedded","onDestroy","Subject","primaryMax","nativeElement","className","indexOf","ngOnInit","tocList","pipe","takeUntil","fn","itemCount","item","level","reduce","result","ngAfterViewInit","combineLatest","activeItemIndex","lift","items","changes","startWith","index","length","e","toArray","p","offsetParent","eRect","getBoundingClientRect","pRect","top","bottom","scrollTop","clientHeight","ngOnDestroy","next","toggle","canScroll","toTop","scrollToTop","TocComponent","customElementComponent","TocModule"],"mappings":"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","file":"toc-toc-module.cdfeef69df0e49a264d7.js","sourcesContent":["/** PURE_IMPORTS_START tslib,_Observable,_scheduler_asap,_util_isNumeric PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Observable } from '../Observable';\nimport { asap } from '../scheduler/asap';\nimport { isNumeric } from '../util/isNumeric';\nvar SubscribeOnObservable = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(SubscribeOnObservable, _super);\n    function SubscribeOnObservable(source, delayTime, scheduler) {\n        if (delayTime === void 0) {\n            delayTime = 0;\n        }\n        if (scheduler === void 0) {\n            scheduler = asap;\n        }\n        var _this = _super.call(this) || this;\n        _this.source = source;\n        _this.delayTime = delayTime;\n        _this.scheduler = scheduler;\n        if (!isNumeric(delayTime) || delayTime < 0) {\n            _this.delayTime = 0;\n        }\n        if (!scheduler || typeof scheduler.schedule !== 'function') {\n            _this.scheduler = asap;\n        }\n        return _this;\n    }\n    SubscribeOnObservable.create = function (source, delay, scheduler) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (scheduler === void 0) {\n            scheduler = asap;\n        }\n        return new SubscribeOnObservable(source, delay, scheduler);\n    };\n    SubscribeOnObservable.dispatch = function (arg) {\n        var source = arg.source, subscriber = arg.subscriber;\n        return this.add(source.subscribe(subscriber));\n    };\n    SubscribeOnObservable.prototype._subscribe = function (subscriber) {\n        var delay = this.delayTime;\n        var source = this.source;\n        var scheduler = this.scheduler;\n        return scheduler.schedule(SubscribeOnObservable.dispatch, delay, {\n            source: source, subscriber: subscriber\n        });\n    };\n    return SubscribeOnObservable;\n}(Observable));\nexport { SubscribeOnObservable };\n//# sourceMappingURL=SubscribeOnObservable.js.map\n","/** PURE_IMPORTS_START _observable_SubscribeOnObservable PURE_IMPORTS_END */\nimport { SubscribeOnObservable } from '../observable/SubscribeOnObservable';\nexport function subscribeOn(scheduler, delay) {\n    if (delay === void 0) {\n        delay = 0;\n    }\n    return function subscribeOnOperatorFunction(source) {\n        return source.lift(new SubscribeOnOperator(scheduler, delay));\n    };\n}\nvar SubscribeOnOperator = /*@__PURE__*/ (function () {\n    function SubscribeOnOperator(scheduler, delay) {\n        this.scheduler = scheduler;\n        this.delay = delay;\n    }\n    SubscribeOnOperator.prototype.call = function (subscriber, source) {\n        return new SubscribeOnObservable(source, this.delay, this.scheduler).subscribe(subscriber);\n    };\n    return SubscribeOnOperator;\n}());\n//# sourceMappingURL=subscribeOn.js.map\n","<div *ngIf=\"type !== 'None'\" class=\"toc-inner no-print\" [class.collapsed]=\"isCollapsed\">\n\n  <div *ngIf=\"type === 'EmbeddedSimple'\" class=\"toc-heading embedded\">\n    Contents\n  </div>\n\n  <button *ngIf=\"type === 'EmbeddedExpandable'\" type=\"button\" (click)=\"toggle(false)\"\n    class=\"toc-heading embedded secondary\"\n    title=\"Expand/collapse contents\"\n    aria-label=\"Expand/collapse contents\"\n    [attr.aria-pressed]=\"!isCollapsed\">\n    Contents\n    <mat-icon class=\"rotating-icon\" svgIcon=\"keyboard_arrow_right\" [class.collapsed]=\"isCollapsed\"></mat-icon>\n  </button>\n\n  <ul class=\"toc-list\" [class.embedded]=\"type !== 'Floating'\">\n    <ng-container *ngFor=\"let toc of tocList; let i = index\">\n      <li #tocItem title=\"{{toc.title}}\" *ngIf=\"type === 'Floating' || toc.level !== 'h1'\"\n        class=\"{{toc.level}}\" [class.secondary]=\"type === 'EmbeddedExpandable' && i >= primaryMax\" [class.active]=\"i === activeIndex\">\n        <a [href]=\"toc.href\" [innerHTML]=\"toc.content\"></a>\n      </li>\n    </ng-container>\n  </ul>\n\n  <button *ngIf=\"type === 'EmbeddedExpandable'\" type=\"button\" (click)=\"toggle()\"\n    class=\"toc-more-items embedded material-icons\" [class.collapsed]=\"isCollapsed\"\n    title=\"Expand/collapse contents\"\n    aria-label=\"Expand/collapse contents\"\n    [attr.aria-pressed]=\"!isCollapsed\">\n  </button>\n</div>\n","import { AfterViewInit, Component, ElementRef, OnDestroy, OnInit, QueryList, ViewChildren } from '@angular/core';\nimport { asapScheduler as asap, combineLatest, Subject } from 'rxjs';\nimport { startWith, subscribeOn, takeUntil } from 'rxjs/operators';\n\nimport { ScrollService } from 'app/shared/scroll.service';\nimport { TocItem, TocService } from 'app/shared/toc.service';\n\ntype TocType = 'None' | 'Floating' | 'EmbeddedSimple' | 'EmbeddedExpandable';\n\n@Component({\n  selector: 'aio-toc',\n  templateUrl: 'toc.component.html',\n  styles: []\n})\nexport class TocComponent implements OnInit, AfterViewInit, OnDestroy {\n\n  activeIndex: number | null = null;\n  type: TocType = 'None';\n  isCollapsed = true;\n  isEmbedded = false;\n  @ViewChildren('tocItem') private items: QueryList<ElementRef>;\n  private onDestroy = new Subject();\n  private primaryMax = 4;\n  tocList: TocItem[];\n\n  constructor(\n    private scrollService: ScrollService,\n    elementRef: ElementRef,\n    private tocService: TocService) {\n    this.isEmbedded = elementRef.nativeElement.className.indexOf('embedded') !== -1;\n  }\n\n  ngOnInit() {\n    this.tocService.tocList\n        .pipe(takeUntil(this.onDestroy))\n        .subscribe(tocList => {\n          this.tocList = tocList;\n          const itemCount = count(this.tocList, item => item.level !== 'h1');\n\n          this.type = (itemCount > 0) ?\n                        this.isEmbedded ?\n                          (itemCount > this.primaryMax) ?\n                            'EmbeddedExpandable' :\n                          'EmbeddedSimple' :\n                        'Floating' :\n                      'None';\n        });\n  }\n\n  ngAfterViewInit() {\n    if (!this.isEmbedded) {\n      // We use the `asap` scheduler because updates to `activeItemIndex` are triggered by DOM changes,\n      // which, in turn, are caused by the rendering that happened due to a ChangeDetection.\n      // Without asap, we would be updating the model while still in a ChangeDetection handler, which is disallowed by Angular.\n      combineLatest(this.tocService.activeItemIndex.pipe(subscribeOn(asap)), this.items.changes.pipe(startWith(this.items)))\n          .pipe(takeUntil(this.onDestroy))\n          .subscribe(([index, items]) => {\n            this.activeIndex = index;\n            if (index === null || index >= items.length) {\n              return;\n            }\n\n            const e = items.toArray()[index].nativeElement;\n            const p = e.offsetParent;\n\n            const eRect = e.getBoundingClientRect();\n            const pRect = p.getBoundingClientRect();\n\n            const isInViewport = (eRect.top >= pRect.top) && (eRect.bottom <= pRect.bottom);\n\n            if (!isInViewport) {\n              p.scrollTop += (eRect.top - pRect.top) - (p.clientHeight / 2);\n            }\n          });\n    }\n  }\n\n  ngOnDestroy() {\n    this.onDestroy.next();\n  }\n\n  toggle(canScroll = true) {\n    this.isCollapsed = !this.isCollapsed;\n    if (canScroll && this.isCollapsed) { this.toTop(); }\n  }\n\n  toTop() {\n    this.scrollService.scrollToTop();\n  }\n}\n\nfunction count<T>(array: T[], fn: (item: T) => boolean) {\n  return array.reduce((result, item) => fn(item) ? result + 1 : result, 0);\n}\n","import { NgModule, Type } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { WithCustomElementComponent } from '../element-registry';\nimport { TocComponent } from './toc.component';\n\n@NgModule({\n  imports: [ CommonModule, MatIconModule ],\n  declarations: [ TocComponent ],\n  entryComponents: [ TocComponent ],\n})\nexport class TocModule implements WithCustomElementComponent {\n  customElementComponent: Type<any> = TocComponent;\n}\n"],"sourceRoot":"webpack:///"}